apiVersion: v1
kind: ConfigMap
metadata:
  name: payment-service-config
  namespace: default
data:
  application.yaml: |
    server:
      port: 8080
      tomcat:
        max-threads: 200
        min-spare-threads: 10
        connection-timeout: 20000
        keep-alive-timeout: 30000
    
    spring:
      datasource:
        hikari:
          maximum-pool-size: 20
          minimum-idle: 5
          connection-timeout: 10000
          idle-timeout: 300000
          max-lifetime: 1200000
          leak-detection-threshold: 60000
      
      jpa:
        hibernate:
          ddl-auto: validate
        properties:
          hibernate:
            jdbc:
              batch_size: 20
              fetch_size: 100
            query:
              plan_cache_max_size: 2048
    
    payment:
      service:
        timeout:
          connect: 5000
          read: 15000
          write: 10000
        retry:
          max-attempts: 3
          backoff-delay: 1000
        circuit-breaker:
          failure-rate-threshold: 50
          wait-duration-in-open-state: 30000
          sliding-window-size: 100
        
        external-apis:
          payment-gateway:
            url: "https://api.paymentgateway.com"
            timeout: 10000
            pool-size: 50
          
          fraud-detection:
            url: "https://api.frauddetection.com"
            timeout: 8000
            pool-size: 30
    
    logging:
      level:
        com.bear.payment: INFO
        org.hibernate.SQL: WARN
        org.springframework.web: WARN
    
    management:
      endpoints:
        web:
          exposure:
            include: health,metrics,prometheus
      metrics:
        export:
          prometheus:
            enabled: true
        distribution:
          percentiles:
            http.server.requests: 0.5, 0.95, 0.99
          percentiles-histogram:
            http.server.requests: true
    
    cache:
      redis:
        host: redis-service
        port: 6379
        timeout: 2000
        jedis:
          pool:
            max-active: 20
            max-idle: 10
            min-idle: 2
            max-wait: 2000